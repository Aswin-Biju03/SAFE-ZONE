{% include 'admin_header.html' %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Place</title>
    <style>
        .error-message {
            color: red;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        .invalid-input {
            border-color: red !important;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.querySelector('form');
            const place = form.querySelector('input[name="place"]');
            const details = form.querySelector('input[name="details"]');
            function validateInput(input, errorId) {
                const textPattern = /^[A-Za-z ]{3,50}$/;
                const errorElement = document.getElementById(errorId);
                if (!textPattern.test(input.value.trim())) {
                    input.classList.add('invalid-input');
                    errorElement.style.display = 'block';
                    return false;
                }
                input.classList.remove('invalid-input');
                errorElement.style.display = 'none';
                return true;
            }
            form.addEventListener('submit', function (e) {
                let isValid = true;
                
                if (!validateInput(place, 'placeError')) isValid = false;
                if (!validateInput(details, 'detailsError')) isValid = false;

                if (!isValid) {
                    e.preventDefault();
                }
            });
            place.addEventListener('input', () => validateInput(place, 'placeError'));
            details.addEventListener('input', () => validateInput(details, 'detailsError'));
        });
        function confirmDelete(url) {
            if (confirm("Are you sure you want to delete this place?")) {
                window.location.href = url;
            }
            return false;
        }
        function confirmUpdate(form) {
            return confirm("Are you sure you want to update this place?");
        }
    </script>
</head>
<body>
<center>
    <br><br><br><br><br>
    <h3>Manage Place</h3>
    <form  method="post" enctype="multipart/form-data" >
        {%if data['upd']%}
        <table>
            <tr><th>Update Place</th>
            <td><input type="text" name="place" value="{{data['upd'][0]['place']}}"class="form-control" required>
            <div id="placeError" class="error-message">Please enter a valid place (3-50 letters)</div></td></tr>
            <th>Update Details</th>
            <td><input type="text" name="details" value="{{data['upd'][0]['details']}}" class="form-control" required>
            <div id="detailsError" class="error-message">Please enter valid details (3-50 letters)</div></td></tr>
            <tr><th><input type="submit" name="up" class="btn btn-primary" value="update" onclick="return confirmUpdate(this.form)"></th></tr>
        </table>
        {%else%}
        <table>
            <tr><th>Place</th>
            <td><input type="text" name="place" placeholder="Place"  class="form-control" required>
            <div id="placeError" class="error-message">Please enter a valid place (3-50 letters)</div></td></tr>
            <tr><th>Details</th>
                <td><input type="text" name="details" placeholder="Details" class="form-control" required>
                <div id="detailsError" class="error-message">Please enter valid details (3-50 letters)</div></td></tr>
            <tr><th><input type="submit" name="add_place" class="btn btn-primary"  value="Add"></th></tr>
        </table>
        {%endif%}
        <br>
        <h4>List of Place</h4>
        <br>
        <table class="t">
            <tr ><th class="t1">Index</th>
            <th class="t1">Place</th>
            <th class="t1">Details</th>
            <th class="t1">Actions</th>
        </tr>
            {%for i in data['resource']%}
            <tr>
                <td class="t1">{{loop.index}}</td>
                <td class="t1">{{i['place']}}</td>
                <td class="t1">{{i['details']}}</td>
                <td class="t1">
                    <a href="javascript:void(0)" onclick="return confirmDelete('?action=delete&place_id={{i['place_id']}}')" class="btn btn-danger" style="margin-right: 10px;">Delete</a>
                    <a href="?action=update&place_id={{i['place_id']}}" class="btn btn-primary">Update</a>
                </td>
                
            </tr>
            {%endfor%}
        </table>
        <br><br><br><br><br><br><br><br><br>    </form>

</center>

{% include 'footer.html' %}